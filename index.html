<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ff85a2">
    <meta name="orientation" content="portrait">
    
    <title>PebbleWay - Track your goals with joy!</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-180x180.png">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Page -->
    <div class="page login-page" id="loginPage">
            <div class="auth-container">
                    <h1>Welcome Back!</h1>
                <form class="auth-form" id="loginForm" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                    </div>
                <div class="error-message" id="loginError"></div>
                <button type="submit" class="auth-button">Log In</button>
                </form>
            <p class="auth-switch">Don't have an account? <a href="#" onclick="showSignup()">Sign Up</a></p>
            </div>
        </div>

    <!-- Signup Page -->
    <div class="page signup-page" id="signupPage">
            <div class="auth-container">
                    <h1>Create Account</h1>
                <form class="auth-form" id="signupForm" onsubmit="handleSignup(event)">
                    <div class="form-group">
                    <label for="signupName">Name</label>
                    <input type="text" id="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="signupConfirmPassword">Confirm Password</label>
                    <input type="password" id="signupConfirmPassword" required>
                    </div>
                <div class="error-message" id="signupError"></div>
                <button type="submit" class="auth-button">Sign Up</button>
                </form>
            <p class="auth-switch">Already have an account? <a href="#" onclick="showLogin()">Log In</a></p>
            </div>
        </div>

    <!-- Home Page -->
    <div class="page home-page" id="homePage">
        <div class="stats-container">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalGoals">0</div>
                        <div class="stat-label">Total Goals</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="completedGoals">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="currentStreak">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>
                <div class="completion-bar-container">
                    <div class="completion-label">
                        <span>Overall Progress</span>
                        <span id="completionPercentage">0%</span>
                    </div>
                    <div class="completion-bar">
                        <div class="completion-progress" id="completionProgress"></div>
                    </div>
                </div>
            </div>
            <div class="content" id="goalsList">
                <!-- Goals will be added here dynamically -->
            </div>
            <div class="button-container">
                <button class="progress-button" onclick="showProgress()">üìä</button>
                <button class="journal-button" onclick="showJournal()">üìù</button>
                <button class="settings-button" onclick="showSettings()">‚öôÔ∏è</button>
                <button class="add-goal-button" onclick="showAddGoalModal()">+</button>
            </div>
        </div>

    <!-- Add Goal Modal -->
    <div class="modal" id="addGoalModal">
        <div class="modal-content">
                <h2>Add New Goal</h2>
            <form id="addGoalForm" onsubmit="addGoal(event)">
                <div class="form-group">
                    <label for="goalTitle">Title</label>
                    <input type="text" id="goalTitle" required>
                </div>
                <div class="form-group">
                    <label for="goalCategory">Category</label>
                    <select id="goalCategory">
                        <option value="health">Health</option>
                        <option value="fitness">Fitness</option>
                        <option value="learning">Learning</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="goalDescription">Description</label>
                    <textarea id="goalDescription"></textarea>
                </div>
                <div class="form-group">
                    <label for="goalTarget">Target (days)</label>
                    <input type="number" id="goalTarget" min="1" required>
                </div>
                <div class="modal-buttons">
                <button type="submit" class="submit-button">Add Goal</button>
                    <button type="button" class="cancel-button" onclick="closeAddGoalModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Initialize data
        let goals = JSON.parse(localStorage.getItem('goals')) || [];
        let streak = parseInt(localStorage.getItem('streak')) || 0;
        let lastCheckIn = localStorage.getItem('lastCheckIn');
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            theme: 'Default Pink',
            fontSize: 'medium',
            dailyReminders: false,
            reminderTime: '09:00'
        };

        // Show login page by default
        document.getElementById('loginPage').classList.add('active');

        // Authentication functions
        function handleSignup(event) {
            event.preventDefault();
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const errorElement = document.getElementById('signupError');

            if (password !== confirmPassword) {
                errorElement.textContent = 'Passwords do not match';
                return;
            }

            // Store user data
            const users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.some(user => user.email === email)) {
                errorElement.textContent = 'Email already registered';
                return;
            }

            users.push({ name, email, password });
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify({ name, email }));

            showNotification('Account created successfully!', 'success');
            document.getElementById('signupPage').classList.remove('active');
            document.getElementById('homePage').classList.add('active');
            updateUI();
        }

        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');

            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.email === email && u.password === password);

            if (!user) {
                errorElement.textContent = 'Invalid email or password';
                return;
            }

            localStorage.setItem('currentUser', JSON.stringify({ name: user.name, email: user.email }));
            showNotification('Welcome back!', 'success');
            document.getElementById('loginPage').classList.remove('active');
            document.getElementById('homePage').classList.add('active');
            updateUI();
        }

        // Goal functions
        function addGoal(event) {
            event.preventDefault();
            const title = document.getElementById('goalTitle').value;
            const category = document.getElementById('goalCategory').value;
            const description = document.getElementById('goalDescription').value;
            const target = parseInt(document.getElementById('goalTarget').value);
            
            goals.push({
                title,
                category,
                description,
                target,
                current: 0,
                completed: false
            });
            
            localStorage.setItem('goals', JSON.stringify(goals));
            updateGoalsList();
            closeAddGoalModal();
            showNotification('Goal added successfully!');
            event.target.reset();
        }

        function checkIn(index) {
            const today = new Date().toDateString();
            if (lastCheckIn === today) {
                showNotification('You have already checked in today!', 'error');
                return;
            }
            
            const goal = goals[index];
            if (goal.current < goal.target) {
                goal.current++;
                if (goal.current === goal.target) {
                    goal.completed = true;
                    showNotification('Congratulations! Goal completed! üéâ');
                }
                
                streak++;
                lastCheckIn = today;

                localStorage.setItem('goals', JSON.stringify(goals));
                localStorage.setItem('streak', streak);
                localStorage.setItem('lastCheckIn', lastCheckIn);
                
                updateGoalsList();
                showNotification('Check-in successful! Keep going! üí™');
            }
        }

        function deleteGoal(index) {
            if (confirm('Are you sure you want to delete this goal?')) {
                goals.splice(index, 1);
                localStorage.setItem('goals', JSON.stringify(goals));
                updateGoalsList();
                showNotification('Goal deleted successfully');
            }
        }

        // UI functions
        function updateGoalsList() {
            const goalsList = document.getElementById('goalsList');
            goalsList.innerHTML = '';

            goals.forEach((goal, index) => {
                const progress = (goal.current / goal.target) * 100;
                const goalElement = document.createElement('div');
                goalElement.className = 'goal-card';
                goalElement.innerHTML = `
                    <div class="goal-title">${goal.title}</div>
                    <div class="goal-category">${goal.category}</div>
                    <div class="goal-description">${goal.description}</div>
                    <div class="goal-progress">
                        <div class="goal-progress-bar" style="width: ${progress}%"></div>
                    </div>
                    <div class="goal-stats">${goal.current}/${goal.target} days</div>
                    <div class="goal-actions">
                        <button onclick="checkIn(${index})" ${goal.completed ? 'disabled' : ''}>Check In</button>
                        <button onclick="deleteGoal(${index})" class="delete">Delete</button>
                    </div>
                `;
                goalsList.appendChild(goalElement);
            });

            updateStats();
        }

        function updateStats() {
            document.getElementById('totalGoals').textContent = goals.length;
            document.getElementById('completedGoals').textContent = goals.filter(g => g.completed).length;
            document.getElementById('currentStreak').textContent = streak;

            const totalProgress = goals.reduce((sum, goal) => sum + (goal.current / goal.target), 0) / goals.length * 100 || 0;
            document.getElementById('completionPercentage').textContent = `${Math.round(totalProgress)}%`;
            document.getElementById('completionProgress').style.width = `${totalProgress}%`;
        }

        function showAddGoalModal() {
            document.getElementById('addGoalModal').style.display = 'flex';
        }

        function closeAddGoalModal() {
            document.getElementById('addGoalModal').style.display = 'none';
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function updateUI() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                document.getElementById('profileName').textContent = currentUser.name;
                document.getElementById('profileEmail').textContent = currentUser.email;
                document.getElementById('profileAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
            }
            updateGoalsList();
        }

        // Initialize UI
        updateUI();
    </script>
</body>
</html> 